Sub ImportTxtFileData()
    Dim filePath As String
    Dim fileContent As String
    Dim dataArray() As String
    Dim rowIndex As Long
    Dim columnIndex As Long
    Dim resultSheet As Worksheet
    
    ' ファイル選択ダイアログを表示し、txtファイルを選択させる
    With Application.FileDialog(msoFileDialogFilePicker)
        .Title = "txtファイルを選択してください"
        .Filters.Add "テキストファイル", "*.txt"
        If .Show = -1 Then
            filePath = .SelectedItems(1)
        Else
            Exit Sub ' ファイルが選択されなかった場合、処理を終了
        End If
    End With
    
    ' テキストファイルを読み込む
    Open filePath For Input As #1
    fileContent = Input$(LOF(1), #1)
    Close #1
    
    ' 改行文字でテキストを分割し、データを配列に格納する
    dataArray = Split(fileContent, vbCrLf)
    
    ' "result"という新しいシートを作成する
    Set resultSheet = ThisWorkbook.Sheets.Add
    resultSheet.Name = "result"
    
    ' データをExcelシートに出力する
    rowIndex = 1
    For Each line In dataArray
        ' コンマで行を分割し、各要素を適切な列に出力する
        columnIndex = 1
        For Each item In Split(line, ",")
            resultSheet.Cells(rowIndex, columnIndex).Value = item
            columnIndex = columnIndex + 1
        Next item
        rowIndex = rowIndex + 1
    Next line
    
    MsgBox "データの読み込みが完了しました。", vbInformation
End Sub
