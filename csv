Sub ImportTxtFileData()
    Dim filePath As String
    Dim fileContent As String
    Dim dataArray() As String
    Dim rowIndex As Long
    Dim columnIndex As Long
    Dim resultSheet As Worksheet
    
    ' ファイル選択ダイアログを表示し、txtファイルを選択させる
    With Application.FileDialog(msoFileDialogFilePicker)
        .Title = "txtファイルを選択してください"
        .Filters.Add "テキストファイル", "*.txt"
        If .Show = -1 Then
            filePath = .SelectedItems(1)
        Else
            Exit Sub ' ファイルが選択されなかった場合、処理を終了
        End If
    End With
    
    ' テキストファイルを1行ずつ読み込み、データを配列に格納する
    Open filePath For Input As #1
    Do Until EOF(1)
        Line Input #1, fileContent
        dataArray = Split(fileContent, ",")
        
        ' "result"という新しいシートを作成する
        If resultSheet Is Nothing Then
            Set resultSheet = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
            resultSheet.Name = "result"
        End If
        
        ' データをExcelシートに出力する
        columnIndex = 1
        For Each item In dataArray
            resultSheet.Cells(rowIndex, columnIndex).Value = item
            columnIndex = columnIndex + 1
        Next item
        
        rowIndex = rowIndex + 1
    Loop
    Close #1
    
    MsgBox "データの読み込みが完了しました。", vbInformation
End Sub
